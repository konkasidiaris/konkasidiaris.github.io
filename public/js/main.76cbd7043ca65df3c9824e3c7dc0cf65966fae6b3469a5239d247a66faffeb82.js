(()=>{function T(){let e=document.documentElement,t=e.style.colorScheme==="dark",r=document.getElementById("dark-mode-toggle");t?(e.style.colorScheme="light",localStorage.setItem("theme","light"),r.classList.remove("dark"),r.setAttribute("aria-label","Enable dark mode")):(e.style.colorScheme="dark",r.classList.add("dark"),localStorage.setItem("theme","dark"),r.setAttribute("aria-label","Enable light mode"))}function f(){let e=localStorage.getItem("theme"),t=window.matchMedia("(prefers-color-scheme: dark)").matches,r=document.getElementById("dark-mode-toggle");(e||(t?"dark":"light"))==="dark"?(document.documentElement.style.colorScheme="dark",r.classList.add("dark"),r.setAttribute("aria-label","Enable light mode")):(document.documentElement.style.colorScheme="light",r.setAttribute("aria-label","Enable dark mode")),document.getElementById("dark-mode-toggle").addEventListener("click",T)}function h(){document.getElementById("hamburger").addEventListener("click",e=>{e.currentTarget.classList.toggle("open")})}async function p(){let e=document.getElementById("kbar"),t=document.getElementById("kbar-input"),r=document.getElementById("searchbox"),o=document.getElementById("kbar-results");if(!e||!t||!r||!o)return;let s=null,d="",i=n=>{o.innerHTML=`<p class="text-sm text-text-muted">${n}</p>`},g=await import("/pagefind/pagefind.js");g.init();async function L(n){let a=n.trim();if(d=a,!a){i("Start typing to search\u2026");return}try{let c=await g.search(a);if(d!==a)return;if(!c?.results?.length){i("No results yet. Try another phrase.");return}console.log(c.results);let u=await Promise.all(c.results.slice(0,10).map(async m=>{let l=await m.data(),S=l.meta?.title??l.url,E=l.excerpt??l.meta?.description??"";return`
                        <a href="${l.url}"
                           class="block rounded-xl border border-border/40 p-3 transition hover:border-primary hover:text-primary focus-visible:outline focus-visible:outline-primary">
                            <p class="font-medium">${S}</p>
                            ${E?`<p class="text-xs text-text-muted">${E}</p>`:""}
                        </a>`}));d===a&&(o.innerHTML=u.join(""))}catch(c){console.error("Pagefind search failed",c),i("Search is temporarily unavailable.")}}function b(){e.classList.contains("flex")||(s=document.activeElement,e.classList.remove("hidden"),e.classList.add("flex"),t.value="",i("Start typing to search\u2026"),t.focus())}function k(){e.classList.contains("flex")&&(e.classList.remove("flex"),e.classList.add("hidden"),s&&s!==r&&typeof s.focus=="function"?s.focus():r.blur())}function v(){let n=document.activeElement;if(!n)return!1;let a=n.tagName?.toLowerCase();return n.isContentEditable||a==="input"||a==="textarea"}function x(n){let a=n.key.toLowerCase(),c=(n.ctrlKey||n.metaKey)&&a==="k",u=!v()&&a==="/",m=a==="escape",l=(n.ctrlKey||n.metaKey)&&a==="c";if(c||u){n.preventDefault(),b();return}(m||l)&&e.classList.contains("flex")&&(n.preventDefault(),k())}document.addEventListener("keydown",x),e.addEventListener("click",n=>{n.target===e&&k()});let w=()=>{b(),r.blur()};r.addEventListener("focus",w),r.addEventListener("click",w),t.addEventListener("input",n=>{L(n.target.value)})}function y(){return"startViewTransition"in document}function D(e){let t=e.target.closest("a");if(!(!t||t.origin!==location.origin||t.target==="_blank")&&!(e.ctrlKey||e.metaKey||e.shiftKey))if(e.preventDefault(),y())try{document.startViewTransition(async()=>{let s=await(await fetch(t.href)).text(),i=new DOMParser().parseFromString(s,"text/html");document.title=i.title,document.body.innerHTML=i.body.innerHTML,history.pushState({},"",t.href),f(),h(),await p()}).finished.catch(()=>{window.location.href=t.href})}catch{window.location.href=t.href}else window.location.href=t.href}function M(){y()?document.startViewTransition(async()=>{let t=await(await fetch(location.href)).text(),o=new DOMParser().parseFromString(t,"text/html");document.title=o.title,document.body.innerHTML=o.body.innerHTML,f(),h(),await p()}):location.reload()}document.addEventListener("DOMContentLoaded",async e=>{y()&&document.startViewTransition(),f(),h(),await p(),document.addEventListener("click",D),window.addEventListener("popstate",M)});})();
